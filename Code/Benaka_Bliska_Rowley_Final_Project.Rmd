---
title: Identifying Priority Conservation Areas in the Florida Everglades for Mangrove Habitat
subtitle: Final Project, ENV 872
author: Isaac Benaka, Hanna Bliska, and Caroline Rowley
date: Fall 2022
output:
 pdf_document: default
editor_options: 
  chunk_output_type: console
---
\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r setup, include=FALSE}
# Set your working directory
#setwd("~/Desktop/BenakaBliskaRowley_ENV872_EDA_FinalProject")
getwd()

# Load your packages
library(tidyverse)
library(lubridate)
library(scales)
library(cowplot)
library(trend)
library(zoo)
library(Kendall)
library(sf)
library(mapview)
library(agricolae)

# Set your ggplot theme
my_theme <- theme_classic(base_size=12) + theme(
  axis.text=element_text(color="black"), 
  legend.position="right")
theme_set(my_theme)

# Load your datasets
FCE.site.coordinates <- read.csv("./Data/Raw/FCE_LTER_site_coordinates.csv")
FCE.nutrients.data <- read.csv("./Data/Raw/FCE_LTER_Nutrients.csv",
                               stringsAsFactors = TRUE)
FCE.tree.data <- read.csv("./Data/Raw/FCE_LTER_Mangroves.csv",
                          stringsAsFactors = TRUE)
inat.birds <- read.csv("./Data/Raw/inaturalist_birds.csv",
                       stringsAsFactors = TRUE)
inat.reptiles <- read.csv("./Data/Raw/inaturalist_reptiles2.csv",
                          stringsAsFactors = TRUE)
inat.mammals <- read.csv("./Data/Raw/inaturalist_mammals.csv",
                         stringsAsFactors = TRUE)  
inat.fishnbugs <- read.csv("./Data/Raw/inaturalist_fish_arachninds_insects.csv", 
                           stringsAsFactors = TRUE)  
inat.amphibians <- read.csv("./Data/Raw/inaturalist_amphibians.csv",
                            stringsAsFactors = TRUE)
inat.plants <- read.csv("./Data/Raw/inaturalist_plants_fungi.csv",
                        stringsAsFactors = TRUE)
mangrove.sf <- st_read("./Data/Spatial/Mangrove_Habitat_in_Florida/Mangrove_Habitat_in_Florida.shp")
park.boundary <- st_read("./Data/Spatial/park/nps_boundary.shp") %>% filter(UNIT_NAME == "Everglades National Park")
# Project spatial data to UTM 17N
mangrove.utm <- st_transform(mangrove.sf,32617)
park.utm <- st_transform(park.boundary,32617)

```


# Rationale and Research Questions

Mangroves are vital coastal ecosystems that support biological diversity and fortify fragile coastlines. Mangrove trees have adapted to live in water with high salinity, and thus these tropical forest trees have created nurseries and habitat for coastal species along sea-land interfaces (Duke et al., 2014). Further, mangrove ecosystems strengthen the shoreline, as they act as a natural barrier against wave- and storm-induced erosion (Duke et al., 2014). As a consequence of human development, agricultural expansion, and climate-change related factors, the distribution and nature of mangrove communities is changing (Duke et al., 2014).  

The Florida Coastal Everglades Long Term Ecological Research (FCE LTER) Site has been monitoring mangrove ecosystems in the Florida Everglades National Park. Their long-term monitoring programs have helped scientists track long-term changes in the mangrove communities for many years (Florida Coastal Everglades LTER, 2022). Their publicly available datasets report variables related to mangrove health, such as height, diameter, species, and nutrient availability. Additionally, citizen scientists have visited the Florida Everglades National Park and collected data on their observations of mangrove-associated species over time through iNaturalist. These databases pose an opportunity for us to investigate factors that may impact mangrove health and consider areas of the park where mangrove ecosystem conservation efforts may be focused to best protect these vital ecosystems.

Our research questions were:
1. Where are mangrove forests spatially located and how has the biomass of mangroves changed over time?
2. Are native, mangrove-associated species decreasing in the park and where are these species observed?
3. How has nutrient availability changed over time and where are the areas of highest concern (i.e., highest nutrient levels) for mangroves?

\newpage

# Dataset Information

```{r, renaming columns, include=FALSE}

#renaming column names and removing repeated header row
colnames(FCE.mean.sea.levels) <- c(
  "Station_ID", "Year", "Month", "MSL")
FCE.mean.sea.levels=FCE.mean.sea.levels[-1,]

colnames(FCE.nutrients.data) <- c(
  "SITE_NAME", "DATE", "TIME", "Salinity", "TN", "TP",
  "TOC", "NH4", "NandN", "NO2", "SRP", "DOC", "NO3")
FCE.nutrients.data=FCE.nutrients.data[-1,]

colnames(FCE.sawgrass.data) <- c(
  "SITE_NAME", "DATE", "Sawgrass_AG_Biomass", "Sawgrass_AG_Biomass_STD",
  "Sawgrass_Culm_Density", "Sawgrass_Culm_Density_STD") 
FCE.sawgrass.data=FCE.sawgrass.data[-1,]

colnames(FCE.site.coordinates) <- c(
  "SITE", "Latitude (Decimal Degrees)", "Longitude (Decimal Degrees)",
  "Latitude (Degrees, minutes)", "Longitude (Degrees, minutes)",
  "Northing (UTM)", "Easting (UTM)")
FCE.site.coordinates=FCE.site.coordinates[-1,]

colnames(FCE.tree.data) <- c(
  "SITE", "DATE", "Plot_ID", "Tree_TagNumber",
  "Species.Tree", "Tree_DBH", "Tree_Height")
FCE.tree.data=FCE.tree.data[-1,]

#wrangling the inaturalist data sets to have the same columns
inat.birds <- inat.birds %>% 
  select(observed_on, latitude, longitude, scientific_name, common_name, iconic_taxon_name, taxon_id, taxon_order_name, taxon_genus_name)

inat.reptiles <- inat.reptiles %>% 
  select(observed_on, latitude, longitude, scientific_name, common_name, iconic_taxon_name, taxon_id, taxon_order_name, taxon_genus_name)

inat.mammals <- inat.mammals %>% 
  select(observed_on, latitude, longitude, scientific_name, common_name, iconic_taxon_name, taxon_id, taxon_order_name, taxon_genus_name)

inat.fishnbugs <- inat.fishnbugs %>% 
  select(observed_on, latitude, longitude, scientific_name, common_name, iconic_taxon_name, taxon_id, taxon_order_name, taxon_genus_name)

inat.amphibians <- inat.amphibians %>% 
  select(observed_on, latitude, longitude, scientific_name, common_name, iconic_taxon_name, taxon_id, taxon_order_name, taxon_genus_name)

inat.plants <- inat.plants %>% 
  select(observed_on, latitude, longitude, scientific_name, common_name, iconic_taxon_name, taxon_id, taxon_order_name, taxon_genus_name)

#combining the inaturalist data sets into one data frame
inat.all <- rbind(inat.amphibians, inat.birds, inat.fishnbugs, inat.mammals, inat.plants, inat.reptiles)

inat.animals <-rbind(inat.birds, inat.amphibians, inat.mammals, inat.reptiles)

```


```{r, formatting data sets, include=FALSE}
#formatting date columns
FCE.nutrients.data$DATE <- as.Date(FCE.nutrients.data$DATE, format="%Y-%m-%d")
FCE.sawgrass.data$DATE <- as.Date(FCE.sawgrass.data$DATE, format="%Y-%m-%d")
FCE.tree.data$DATE <- as.Date(FCE.tree.data$DATE, format = "%Y-%m-%d")
inat.animals$observed_on <- as.Date(inat.animals$observed_on, format("%Y-%m-%d"))

#formatting numeric values
FCE.nutrients.data$TP <- as.numeric(FCE.nutrients.data$TP)
FCE.nutrients.data$TN <- as.numeric(FCE.nutrients.data$TN)
FCE.tree.data$Tree_DBH <- as.numeric(FCE.tree.data$Tree_DBH)

#wrangling site coordinates data frame to have matching sites
FCE.site.coordinates$SITE <- as.character(FCE.site.coordinates$SITE) 
#convert to character
FCE.site.coordinates$SITE <- gsub('\\s+', '', FCE.site.coordinates$SITE) 
#remove spaces from SITE codes to join to other datasets
FCE.site.coordinates$SITE <- as.factor(FCE.site.coordinates$SITE) 
#convert back to factor
```

## Mangrove Data Sets

## Species Data Set

## Nutrient Data Set
Data on nutrient concentrations in the Everglades National Park were obtained from the Florida Coastal Everglades Long Term Ecological Research Site (FCE LTER). We downloaded the data on November 15, 2022 using the Environmental Data Initiative Data Portal (https://portal.edirepository.org/nis/home.jsp), where publicly available data for LTERs can be accessed. The data set selected was titled Water Quality Data (Grab Samples) from the Shark River Slough, Everglades National Park (FCE LTER), May 2001 - ongoing.  

This data set obtained nutrient data for 8 long-term mangrove vegetation monitoring plots. Since mangroves are nutrient-sensitive species (Feller et al. 2007), this data set would allow us to understand where mangrove ecosystems may be stressed due to nutrient concentrations. The data set was initially wrangled for utility in R; we renamed columns, changed the format of the data, and joined the coordinate data for each plot to the data set. Due to the sensitivity of mangroves to nitrogen and phosphorus (Feller et al. 2007), we chose to focus our analyses on these two nutrients.

For time series analysis, we wrangled the data to determine the mean monthly and yearly nitrogen and phosphorus measurements within the monitoring sites. For the yearly measurements, we extracted the years from the date observations to create a new year column, and then averaged the nitrogen and phosphorus measurements within each year using the `group_by` and `summarize` functions in R. For the monthly measurements, we extracted the months from the date observations to create a new month column, and then averaged the nitrogen and phosphorus measurements within each month using the `group_by` and `summarize` functions in R. We then created a sequence of all of the months between the first and last data observation (May 2001 to December 2021) and joined this data to the original data frame to ensure there was an observation for every month between the first and last data observation date. 
The final data structure for the yearly data sets is as follows:
| Variable   | Units      | Range         | Mean    |
| ---------- | ---------  | ------------- | ------- |
| YEAR       | YYYY       | 2001-2021     | N/A     |
| MEAN_TN    | mcmol/L    | 416.7 - 950.3 | 699.2   |
| MEAN_TP    | mcmol/L    | 21.64 - 75.26 | 45.36   |

The final data structure for the monthly data sets is as follows:
| Variable   | Units      | Range                   | Mean    |
| ---------- | ---------  | ----------------------- | ------- |
| Date       | YYYY-MM-DD | 2001-05-01 - 2021-12-01 | N/A     |
| year       | YYYY       | 2001-2021               | N/A     |
| month      | MM         | 1-12                    | N/A     |
| MEAN_TN    | mcmol/L    | 147-1232                | 698.3   |
| MEAN_TP    | mcmol/L    | 5.167-141.833           | 46.021  |

For site comparison analysis, we wrangled the data to select only nitrogen and phosphorus for each site using the `select` function in R. 

The final data structure for the data set is as follows:
| Variable   | Units            | Range                   | Mean    |
| ---------- | ---------------- | ----------------------- | ------- |
| SITE_NAME  | N/A              | 8 different sites       | N/A     |
| DATE       | YYYY-mm-dd       | 2001-05-23 - 2021-12-06 | N/A     |
| TP         | mcmol/L          | 1 - 155                 | 45.6    |
| TN         | mcmol/L          | 1 - 1394                | 698.6   |
| Latitude   | Degrees, minutes | N/A                     | N/A     |
| Longitude  | Degrees, minutes | N/A                     | N/A     |
| Northing   | UTM degrees N    | N/A                     | N/A     |
| Easting    | UTM degrees W    | N/A                     | N/A     |
| Geometry   | x,y coordinates  | N/A                     | N/A     |

```{r, wrangling nutrients data set for mean P and N for each year, include=FALSE}
FCE.phos.yearly.data <- FCE.nutrients.data %>%
  select(SITE_NAME, DATE, TP) %>% #selecting variables of interest
  mutate(YEAR=year(DATE)) %>% #creating year column
  group_by(YEAR) %>% #grouping by year
  summarise(MEAN_TP=mean(TP)) #averaging the TP for each year

#saving as processed data frame
write.csv(FCE.phos.yearly.data, row.names = FALSE, file= "./Data/Processed/FCE.phos.yearly.data.csv")
  
FCE.nitro.yearly.data <- FCE.nutrients.data %>%
  select(SITE_NAME, DATE, TN) %>% #selecting variables of interest
  mutate(YEAR=year(DATE)) %>% #creating year column
  group_by(YEAR) %>% #grouping by year
  summarise(MEAN_TN=mean(TN))  #averaging the TN for each year

#saving as a processed data frame
write.csv(FCE.nitro.yearly.data, row.names = FALSE, file= "./Data/Processed/FCE.nitro.yearly.data.csv")
```

```{r, wranging nutrients data for mean P and N for each month, include=FALSE}
#monthly phosphorus averages
FCE.phos.monthly.data <- FCE.nutrients.data %>%
  select(SITE_NAME, DATE, TP) %>%
  mutate(month = month(DATE)) %>% #adding month column
  mutate(year = year(DATE)) %>% #adding a year column
  group_by(year, month) %>% #grouping by year and month
  summarise(MEAN_TP=mean(TP)) #averaging the TP for each month of the year

FCE.phos.monthly.data <- FCE.phos.monthly.data %>%
  mutate("Date"=my(paste0(month,"-",year))) #creating a new date column
  #observations are for the first of the month

Months <- as.data.frame(seq(
  as.Date("2001-05-01"), as.Date("2021-12-01"),"months")) 
#creating a data frame of monthly dates from May 2001 to December 2021
#will ultimately allow us to identify months that do not have observations
#and then interpolate those at a later point

colnames(Months) <- c("Date") #renaming column name

FCE.phos.monthly.data <- left_join(
  Months, FCE.phos.monthly.data, by = c("Date"))
#joining data frames so that there is an observation for 
#each month of the year from May 2001 to December 2021

#saving as a processed data frame
write.csv(FCE.phos.monthly.data, row.names = FALSE, file= "./Data/Processed/FCE.phos.monthly.data.csv")
  
#nitrogen 
FCE.nitro.monthly.data <- FCE.nutrients.data %>%
  select(SITE_NAME, DATE, TN) %>%
  mutate(month = month(DATE)) %>% #adding month column
  mutate(year = year(DATE)) %>% #adding a year column
  group_by(year, month) %>% #grouping by year and month
  summarise(MEAN_TN=mean(TN)) #averaging the TN for each month of the year

FCE.nitro.monthly.data <- FCE.nitro.monthly.data %>%
  mutate("Date"=my(paste0(month,"-",year))) #creating a new date column
  #observations are for the first of the month

FCE.nitro.monthly.data <- left_join(
  Months, FCE.nitro.monthly.data, by = c("Date"))
#joining data frames so that there is an observation for 
#each month of the year from May 2001 to December 2021

#saving as a processed data frame
write.csv(FCE.nitro.monthly.data, row.names = FALSE, file= "./Data/Processed/FCE.phos.monthly.data.csv")
```

```{r, wrangling nutrients data set for site differences, include=FALSE}
FCE.site.nutrient.data <- FCE.nutrients.data %>%
  select(SITE_NAME, DATE, TP, TN) #selecting variables 
#of interest for site comparisons

#saving as a processed data frame
write.csv(FCE.site.nutrient.data, row.names = FALSE, file= "./Data/Processed/FCE.phos.monthly.data.csv")

```

\newpage

# Exploratory Analysis 

## Mangrove Data
```{r, mangrove distribution, echo=FALSE, include=FALSE}
# Crop mangrove shapefile to Everglades National Park boundary.
mangrove.area <- mangrove.utm[park.utm,] %>% group_by(SOURCEDATE)
# Generate map of mangrove habitat in Everglades National Park.
mapview(mangrove.area, color = "green", col.regions = "dark green", alpha.regions = .4) + mapview(park.boundary, color = 'black', lwd = 2, col.regions = "black", alpha.regions = 0)
```

## Species Data

## Nutrient Data

To address Research Question #3, we were interested in exploring trends of nutrient concentrations in the vegetation plots over time. We calculated mean measurements of phosphorus and nitrogen for each year in the Florida Coastal Everglades. Our initial visualization of the relationship between time and mean phosphorus as well as mean nitrogen suggested that there was likely an increasing trend in phosphorus concentrations over time (Figure 1) and nitrogen concentrations over time (Figure 2). The results of these visualizations motivated us to later analyze if there was a significant increasing trend in nutrient concentrations over time.

```{r echo=FALSE, phosphorus visualization over time, include=FALSE}
phos.plot <- ggplot(FCE.phos.yearly.data, aes(x=YEAR, y=MEAN_TP)) +
  geom_point()+
  geom_smooth(method=lm, se=FALSE, color="blue")+
  xlab(expression("Date")) +
  ylab(expression("Mean Total Phosphorus (mcmol/L)")) +
  ggtitle(expression("Mean Total Phosphorus Measurements"),
          subtitle="Florida Coastal Everglades")
phos.plot
```
Figure 1. Mean total phosphorus measurements over time in the Florida Coastal Everglades.

```{r echo=FALSE, nitrogen visualization over time, include=FALSE}
nitro.plot <- ggplot(FCE.nitro.yearly.data, aes(x=YEAR, y=MEAN_TN)) +
  geom_point()+
  geom_smooth(method=lm, se=FALSE, color="blue") +
  xlab(expression("Date")) +
  ylab(expression("Mean Total Nitrogen (mcmol/L)")) +
  ggtitle(expression("Mean Total Nitrogen Measurements"),
          subtitle="Florida Coastal Everglades")
nitro.plot
```
Figure 2. Mean total nitrogen measurements over time in the Florida Coastal Everglades.

We were also interested in identifying areas of mangrove habitat within the Florida Coastal Everglades that may be stressed due to high nutrient concentrations. Therefore, we initially examined if different mangrove vegetation plots in the park had different phosphorus and nitrogen concentrations. Our initial visualization suggested that some sites, such as site SRS6, may have higher phosphorus concentrations (Figures 3-4). Similarly, our initial visualization suggested the site SRS1d may have higher nitrogen concentrations (Figures 5-6). These visualizations motivated further analysis to determine if the concentrations at different sites were significantly different from one another.

```{r echo=FALSE, phosphorus initial site visualization, include=FALSE}
phos.site.plot <- ggplot(FCE.site.nutrient.data, aes(x=SITE_NAME, y=TP)) +
  geom_boxplot()+
  xlab(expression("Site Name")) +
  ylab(expression("Total Phosphorus (mcmol/L)")) +
  ggtitle(expression("Total Phosphorus Measurements for Sites"),
          subtitle="Florida Coastal Everglades")
phos.site.plot
```
Figure 3. Total phosphorus measurements for sites in the Florida Coastal Everglades.

```{r, echo=FALSE, phosphorus site map, include=FALSE}
mapview(site.locations.nutrients.sf, zcol="TP")
```
Figure 4. Map of Florida Coastal Everglades indicating level of phosphorus measurements per site.

```{r echo=FALSE, nitrogen initial site visualization, include=FALSE}
nitro.site.plot <- ggplot(FCE.site.nutrient.data, aes(x=SITE_NAME, y=TN)) +
  geom_boxplot()+
  xlab(expression("Site Name")) +
  ylab(expression("Total Nitrogen (mcmol/L)")) +
  ggtitle(expression("Total Nitrogen Measurements for Sites"),
          subtitle="Florida Coastal Everglades")
nitro.site.plot
```
Figure 5. Total nitrogen measurements for sites in the Florida Coastal Everglades.

```{r, echo=FALSE, nitrogen site map, include=FALSE}
mapview(site.locations.nutrients.sf, zcol="TN")
```
Figure 6. Map of Florida Coastal Everglades indicating level of nitrogen measurements per site.

\newpage

# Analysis

## Question 1: Where are mangrove forests spatially located and how has the biomass of mangroves changed over time?

## Question 2: Are native, mangrove-associated species decreasing in the park and where are these species observed?

## Question 3: How has nutrient availability changed over time and where are the areas of highest concern for mangroves?

There was a significant increasing trend in mean monthly phosphorus levels in the Florida Coastal Everglades over time (Mann-Kendall test, score=12204, p-value =< 2.2e-16). It is evident that the trend has increasing at a relatively consistent rate over time (Figure 1). 

```{r, time series analysis for phosphorus, include=FALSE}
FCE.phos.monthly.data$MEAN_TP <- 
  na.approx(FCE.phos.monthly.data$MEAN_TP) #using`na.approx`
#to fill in missing monthly data

FCE.phos.monthly.ts <- ts(
  FCE.phos.monthly.data$MEAN_TP, 
  start=c(2001,5), end=c(2021,12),frequency=12) 
#generating time series object
#monthly measurements, using 12

FCE.phos.monthly.ts.decomposed <- stl(
  FCE.phos.monthly.ts, s.window = "periodic") 
#decomposing daily time series
plot(FCE.phos.monthly.ts.decomposed) #plotting components

#running mann kendall
FCE.phos.monthly.ts.trend <- MannKendall(FCE.phos.monthly.ts) 
#using `MannKendall` for trend analysis
summary(FCE.phos.monthly.ts.trend) #summary
```

```{r, time series visualizations of phosphorus, echo=FALSE, include=FALSE}
plot.mean.monthly.phos <- ggplot(
  FCE.phos.monthly.data, aes(
    x=Date, y=MEAN_TP)) + #setting axes
  geom_point() + #generating scatter plot
  geom_line() + #generating line plot
  scale_x_date(date_breaks="1 year", labels=date_format("%m-%Y")) +
  #using `scale_x_date` to generate a break every 6 months
  #labels to show month-date-year
  theme(axis.text.x=element_text(angle=60, hjust=1)) + 
  #angle for the day-month-year labels
  xlab(expression("Date")) + #setting x axis label
  ylab(expression ("Mean Monthly Phosphorus Levels (mcmol/L)")) +
#setting y axis label
  geom_smooth(method=lm, se = FALSE, color="red") + #adding linear trend
  ggtitle(expression("Mean Monthly Phosphorus Levels from 2001-2021"),
          subtitle="Florida Coastal Everglades")
print(plot.mean.monthly.phos) #printing plot
```
Figure 1. Mean monthly phosphorus levels from 2001-2021 in the Florida Coastal Everglades.

There was also significant increasing trend in mean monthly nitrogen levels in the Florida Coastal Everglades over time (Mann-Kendall test, score=9896, p-value =< 2.2e-16). Since 2001, mean monthly nitrogen levels have risen to over 750 mcmol/L (Figure 2). 

```{r, time series analysis for nitrogen, include=FALSE}
FCE.nitro.monthly.data$MEAN_TN <- 
  na.approx(FCE.nitro.monthly.data$MEAN_TN) #using`na.approx`
#to fill in missing monthly data

FCE.nitro.monthly.ts <- ts(
  FCE.nitro.monthly.data$MEAN_TN, 
  start=c(2001,5), end=c(2021,12),frequency=12) 
#generating time series object
#monthly measurements, using 12

FCE.nitro.monthly.ts.decomposed <- stl(
  FCE.nitro.monthly.ts, s.window = "periodic") 
#decomposing daily time series
plot(FCE.nitro.monthly.ts.decomposed) #plotting components

#running mann kendall
FCE.nitro.monthly.ts.trend <- MannKendall(FCE.nitro.monthly.ts) 
#using `MannKendall` for trend analysis
summary(FCE.nitro.monthly.ts.trend) #summary
```

```{r, time series visualizations of nitrogen, echo=FALSE, include=FALSE}
plot.mean.monthly.nitro <- ggplot(
  FCE.nitro.monthly.data, aes(
    x=Date, y=MEAN_TN)) + #setting axes
  geom_point() + #generating scatter plot
  geom_line() + #generating line plot
  scale_x_date(date_breaks="1 year", labels=date_format("%m-%Y")) +
  #using `scale_x_date` to generate a break every 6 months
  #labels to show month-date-year
  theme(axis.text.x=element_text(angle=60, hjust=1)) + 
  #angle for the day-month-year labels
  xlab(expression("Date")) + #setting x axis label
  ylab(expression ("Mean Monthly Nitrogen Levels (mcmol/L)")) +
#setting y axis label
  geom_smooth(method=lm, se = FALSE, color="red") + #adding linear trend
  ggtitle(expression("Mean Monthly Nitrogen Levels from 2001-2021"),
          subtitle="Florida Coastal Everglades")
print(plot.mean.monthly.nitro) #printing plot
```

The results of the time series analyses indicate that mean monthly concentrations of nitrogen and phosphorus have increased over time in the Florida Coastal Everglades.

In the Florida Coastal Everglades, phosphorus concentrations varied significantly among the 8 mangrove habitat sites (ANOVA, df=7, F=28.75, p<0.001). The HSD test determined that site SRS6 had a mean phosphorus measurement that was statistically distinct from all other sites. SRS5 also had a mean phosphorus measurement that was statistically distinct from all other sites. It is evident that site SRS6 had the highest mean phosphorus measurements of all sites (Figure 3).

```{r, site analysis for phosphorus, include=FALSE}
#running anova to see if particular sites have more phosphorus
phos.site.anova <- aov(data=FCE.site.nutrient.data, 
                           TP ~ SITE_NAME)
summary(phos.site.anova)

#evaluating groups
phos.site.anova.groups <- HSD.test(phos.site.anova, 
                                       "SITE_NAME", 
                                       group = TRUE)
#printing groups
phos.site.anova.groups

#results indicate that there are four groups of sites: a, b, c, d. There is only one site that is in group a and only one site in group b. 
```

```{r, visualization of ANOVA analysis for phosphorus, echo=FALSE, include=FALSE}
anova.phos.site.plot <- ggplot(FCE.site.nutrient.data, aes(x=SITE_NAME, y=TP)) +
  geom_boxplot()+
  xlab(expression("Site Name")) +
  ylab(expression("Phosphorus (mcmol/L)")) +
  ggtitle(expression("Phosphorus Measurements for Sites"),
          subtitle="Florida Coastal Everglades") +
  annotate("text", x = 1, y = 200, label = "d") +
  annotate("text", x = 2, y = 200, label = "d") +
  annotate("text", x = 3, y = 200, label = "cd") +
  annotate("text", x = 4, y = 200, label = "d") +
  annotate("text", x = 5, y = 200, label = "cd") +
  annotate("text", x = 6, y = 200, label = "c") +
  annotate("text", x = 7, y = 200, label = "b") +
  annotate("text", x = 8, y = 200, label = "a")
anova.phos.site.plot
```
Figure 3. Phosphorus measurements for mangrove habitat sites in the Florida Coastal Everglades.

Nitrogen concentrations also varied significantly among the 8 mangrove habitat sites (ANOVA, df=7, F=18.68, p<0.001). The HSD test determined that the mean nitrogen concentrations of site SRS1d, SRS2, SRS3, and SRS4 were statistically similar to one another. These sites had the highest mean nitrogen measurements of all sites (Figure 4). The HSD test also determined that the mean nitrogen measurements of sites SRS1a, SRS1c, and SRS6 were statistically similar. These sites had the lowest mean nitrogen measurements (Figure 4).

```{r, site analysis for nitrogen, include=FALSE}
#running anova to see if particular sites have more nitrogen
nitrogen.site.anova <- aov(data=FCE.site.nutrient.data, 
                           TN ~ SITE_NAME)
summary(nitrogen.site.anova)

#evaluating groups
nitrogen.site.anova.groups <- HSD.test(nitrogen.site.anova, 
                                       "SITE_NAME", 
                                       group = TRUE)
#printing groups
nitrogen.site.anova.groups

#results indicate that there are three groups of sites: a, b, and c.
```

```{r, visualization of ANOVA analysis for nitrogen, echo=FALSE, include=FALSE}
anova.nitro.site.plot <- ggplot(FCE.site.nutrient.data, aes(x=SITE_NAME, y=TN)) +
  geom_boxplot()+
  xlab(expression("Site Name")) +
  ylab(expression("Nitrogen (mcmol/L)")) +
  ggtitle(expression("Nitrogen Measurements for Sites"),
          subtitle="Florida Coastal Everglades") +
  annotate("text", x = 1, y = 1500, label = "bc") +
  annotate("text", x = 2, y = 1500, label = "bc") +
  annotate("text", x = 3, y = 1500, label = "a") +
  annotate("text", x = 4, y = 1500, label = "a") +
  annotate("text", x = 5, y = 1500, label = "a") +
  annotate("text", x = 6, y = 1500, label = "ab") +
  annotate("text", x = 7, y = 1500, label = "b") +
  annotate("text", x = 8, y = 1500, label = "c")
anova.nitro.site.plot
```
Figure 4. Phosphorus measurements for mangrove habitat sites in the Florida Coastal Everglades.

The results of the ANOVAs indicated that particular areas of Everglades National Park have elevated nutrient concentrations. Notably, sites SRS5 and SRS6 had the highest phosphorus concentrations, while sites SRS1d, SRS2, SRS3, and SRS4 have elevated nitrogen concentrations.

\newpage

# Summary and Conclusions


\newpage

# References

Duke, N., Nagelkerken, I., Agardy, T., Wells, S., & Van Lavieren, H. (2014). The importance of mangroves to people: a call to action. United Nations Environment Programme World Conservation Monitoring Centre (UNEP-WCMC).

Feller, I. C., Lovelock, C. E., & McKee, K. L. (2007). Nutrient addition differentially affects ecological processes of Avicennia germinans in nitrogen versus phosphorus limited mangrove ecosystems. Ecosystems, 10(3), 347-359.

Florida Coastal Everglades LTER. (2022). About. https://fcelter.fiu.edu/about/index.html. 

